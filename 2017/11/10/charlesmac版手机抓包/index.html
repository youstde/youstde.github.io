<!DOCTYPE html>
<html lang="">
  <head><meta name="generator" content="Hexo 3.8.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

<meta name="theme-color" content="#f8f5ec">
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="charles mac版手机抓包">













  <link rel="alternate" href="/atom.xml" title="子墨">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.png?v=2.10.1">



<link rel="canonical" href="http://yoursite.com/2017/11/10/charlesmac版手机抓包/">



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css">




  <link rel="stylesheet" type="text/css" href="/lib/nprogress/nprogress.min.css">



<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.10.1">



  



  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>









<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":true};
</script>

    <title> charles mac版手机抓包 - 子墨 </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">子墨</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            首页
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            归档
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">子墨</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              首页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          charles mac版手机抓包
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-11-10
        </span>
        
        
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#charles-mac版手机抓包"><span class="toc-text">charles mac版手机抓包</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#官网"><span class="toc-text">官网</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装设置"><span class="toc-text">安装设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#链接设置"><span class="toc-text">链接设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#抓包分析"><span class="toc-text">抓包分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#overview"><span class="toc-text">overview</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#request"><span class="toc-text">request</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#response"><span class="toc-text">response</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#高级功能"><span class="toc-text">高级功能</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#禁止缓存"><span class="toc-text">禁止缓存</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#禁止cookie"><span class="toc-text">禁止cookie</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#远程映射"><span class="toc-text">远程映射</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查看远程映射记录"><span class="toc-text">查看远程映射记录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#远程映射非常有用"><span class="toc-text">远程映射非常有用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#断点"><span class="toc-text">断点</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#重要作用"><span class="toc-text">重要作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#设置"><span class="toc-text">设置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用示例，request修改cookie"><span class="toc-text">使用示例，request修改cookie</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#https抓包"><span class="toc-text">https抓包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#其它功能"><span class="toc-text">其它功能</span></a></li></ol></li></ol></li></ol>
    </div>
  </div>



    <div class="post-content">
      
        <h2 id="charles-mac版手机抓包"><a href="#charles-mac版手机抓包" class="headerlink" title="charles mac版手机抓包"></a>charles mac版手机抓包</h2><ul>
<li><a href="#官网">官网</a></li>
<li><a href="#安装设置">安装设置</a></li>
<li><a href="#链接设置">手机抓包设置</a></li>
<li><a href="#抓包分析">抓包分析</a><ul>
<li><a href="#overview">overview</a> </li>
<li><a href="#request">request</a></li>
<li><a href="#response">response</a></li>
</ul>
</li>
<li><a href="#高级功能">高级功能</a><ul>
<li><a href="#禁止缓存">禁止缓存</a></li>
<li><a href="#禁止cookie">禁止cookie</a></li>
<li><a href="#远程映射">远程映射</a><ul>
<li><a href="#远程映射">设置</a></li>
<li><a href="#查看远程映射记录">查看远程映射记录</a></li>
<li><a href="#远程映射非常有用">远程映射非常有用</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#断点">断点</a><ul>
<li><a href="#重要作用">重要作用</a></li>
<li><a href="#设置">设置</a></li>
<li><a href="#使用示例，request修改cookie">使用示例，request修改cookie</a></li>
</ul>
</li>
<li><a href="#https抓包">https抓包</a></li>
<li><a href="#其它功能">其它功能</a></li>
</ul>
<h3 id="官网">官网</h3>

<p> <a href="http://www.charlesproxy.com" target="_blank" rel="noopener">http://www.charlesproxy.com</a></p>
<h3 id="安装设置">安装设置</h3>

<p> mac按提示安装</p>
<p> 安装完成后需要给charles权限,如果没有给予权限，charles无法抓包。</p>
<p> 点击proxy-&gt;MAC OS X proxy</p>
<p><img src="http://wd.geilicdn.com/5302846b55bfdd37e50cdffa911baaa1.png" style="max-width:100%;width:550px;"></p>
<h3 id="链接设置">链接设置</h3>

<p><img src="http://wd.geilicdn.com/9c9a8999f37e0dcb1a693b055072d8c3.jpg" style="max-width:100%;width:350px;"></p>
<p> ifconfig 找到电脑ip 服务器填电脑ip 端口默认8888（下图）</p>
<p><img src="http://wd.geilicdn.com/7329b383030de145c512450f811debb3.jpg" style="max-width:100%;width:350px;"></p>
<p> 此时charles会自动弹出对话问是否允许通过chales代理访问。点击allow。如果想默认允许任何用户访问， 打开 面包Setting-&gt;Access Control Settings面板，点击add按钮 增加 &lt;0.0.0.0&gt;/0，以后就不会有该对话了。</p>
<h3 id="抓包分析">抓包分析</h3>

<h4 id="overview">overview</h4>

<p><img src="http://wd.geilicdn.com/64c8e8965e4447ba28a330681b555a46.png" style="max-width:100%"></p>
<p> （上图）包含了请求一些基本信息，如地址，请求方式、内容类型、耗时等等</p>
<h4 id="request">request</h4>

<p><img src="http://wd.geilicdn.com/733cc67d3051e3131cba5b6e2ec4c612.png" style="max-width:100%"></p>
<p> (上图) 上图包含的信息非常重要， 说明此处http请求有多少数据发给服务端，如常用的cookie信息和user-agent（浏览器表示）信息</p>
<p> Query string 、 Cookies 和 Raw tab为格式化信息，方便查看（下图）</p>
<p><img src="http://wd.geilicdn.com/b30ed7940330a550e41ad8388f1d5cf5.png" style="max-width:100%"></p>
<p> 双击后可以复制里面信息，不可编辑（如下图）</p>
<p><img src="http://wd.geilicdn.com/856ec0ae20c2b094aa395db9557e1d2b.png" style="max-width:100%"></p>
<h4 id="response">response</h4>

<p> 可以看到非常详细返回信息,Set-cookie,表明本次请求服务端设置了哪些cookie（双击后可复制不可编辑）</p>
<p><img src="http://wd.geilicdn.com/31f24d8896fa3f1a11fc83a2fc370c94.png"></p>
<p> Summary、Chart、Notes等是请求耗时解析，建议在chrome浏览器查看，更加详细和一目了然（以下chrome截图）</p>
<p><img src="http://wd.geilicdn.com/01ea3a51a2c2c6700c8749385517af81.png" style="max-width:100%"></p>
<blockquote>
<p>Queueing 浏览器有连接限制，当网页资源很多时就会出现排队的现象，排队的资源要等到上一个资源加载完毕释放后才能开始请求。比关键资源（如javascript与css）低优先级的请求会被浏览器推迟，一般推迟的都是图片。在许多资源同时发起请求时浏览器默认先加载css,然后javascript，最后才是图片。</p>
</blockquote>
<blockquote>
<p>Stalled 浏览器得到要发出这个请求的指令，到请求可以发出的等待时间，一般是代理协商、以及等待可复用的TCP连接释放的时间，不包括DNS查询、建立TCP连接等时间等</p>
</blockquote>
<blockquote>
<p>Request sent 请求第一个字节发出前到最后一个字节发出后的时间，也就是上传时间</p>
</blockquote>
<blockquote>
<p>Waiting 请求发出完成后，到收到响应的第一个字节所花费的时间(Time To First Byte)，即响应时间</p>
</blockquote>
<blockquote>
<p>Content Download 收到响应的第一个字节，到接受完最后一个字节的时间，就是下载时间</p>
</blockquote>
<h3 id="高级功能">高级功能</h3>

<h4 id="禁止缓存">禁止缓存</h4>

<p><img src="http://wd.geilicdn.com/e175b11d19b9ae5ee59f34ffd5aa0033.png"></p>
<h4 id="禁止cookie">禁止cookie</h4>

<p><img src="http://wd.geilicdn.com/50abc28165e013d235082fbb371d0a7a.png"></p>
<h4 id="远程映射">远程映射</h4>



<p> 选中一个请求-》右键-》Map Remote(下图) 弹出（下图2）</p>
<p><img src="http://wd.geilicdn.com/6924af6c2d76434da988fa87affe9091.png" style="max-width:100%;"></p>
<p><img src="http://wd.geilicdn.com/18442d24d541f6ed726390c7a158858f.png" style="max-width:100%;"></p>
<p> 如果请求的参数有随机数，一定要将参数设置为通配符（**），否者下次请求的时候讲无法配对，导致映射失败。</p>
<h4 id="查看远程映射记录">查看远程映射记录</h4>

<p> 电脑菜单栏tools-》Map Remote</p>
<p><img src="http://wd.geilicdn.com/e7c746b7706f4562b93e03af1ce44466.png"></p>
<p>​    弹出下图</p>
<p><img src="http://wd.geilicdn.com/a1fcbe29b318a336e375d1aaebf7b532.png" style="max-width:100%;"></p>
<h4 id="远程映射非常有用">远程映射非常有用</h4>

<p> 其作用是可以将一个地址代理成其他地址，开发和测试的通过这种方式使用线上app来进行调试和开发，无需繁琐的后台配置。</p>
<p> 或者通过这种方式修改api数据，调试线上js bug 等等。</p>
<h3 id="断点">断点</h3>

<h4 id="重要作用">重要作用</h4>

<p> 修改请求或者返回的header信息，包括cookie，修改请求的参数，修改返回的内容</p>
<h4 id="设置">设置</h4> 

<p> 右键点击请求，选择BreakPoints，刷新页面后碰到这个请求后断点生效。（如下图）</p>
<p><img src="http://wd.geilicdn.com/7b32fed2da0e1d7ea98147723f49e836.png" style="max-width:100%;"></p>
<p> 此时会在request和response进行两次打断，</p>
<p> 如果只需要打断一次可以对面板进行设置</p>
<p> 点击电脑菜单栏Proxy-》Breakpoints Settings （如下图）</p>
<p><img src="http://wd.geilicdn.com/8a25a083a37f01d1d5aad8072e9b4730.png" style="max-width:100%;"></p>
<p> 弹出下图</p>
<p><img src="http://wd.geilicdn.com/8a616e0a06d8d8d4c8e15d6d3c64473f.png" style="max-width:100%;"></p>
<p> 双击列表数据进入编辑模式（如下图）</p>
<p><img src="http://wd.geilicdn.com/e3a32017eec58f3fa3c1dbf9b5881c72.png" style="max-width:100%;"></p>
<p> 如果只选择了request，那么只会在发送请求的时候打断</p>
<p> 如果只选择了response， 那么只会在返回的时候打断</p>
<p> 如果都选，打断两次</p>
<h4 id="使用示例，request修改cookie">使用示例，request修改cookie</h4>

<p><img src="http://wd.geilicdn.com/8bc7865f869f2a5395692b01fddde9f4.png" style="max-width:100%;"></p>
<h4 id="https抓包">https抓包</h4>

<p>​     step1：打开charles，选择菜单“Help” =&gt; “SSL Proxying” =&gt; “Install Charles Root Certificate”，安装根证书（如果是在手机上，请选择 Install Charles Root Certificate on a Mobile Device or Remote Browser…，在手机上安装根证书)        </p>
<p><img src="http://wd.geilicdn.com/9c0cf311cdb5763706498f448f59854a.png" style="max-width:100%;margin:5px 0 15px 0"></p>
<p>​     step2：打开钥匙串访问，找到 “Charles Proxy Custom Root Certificate证书”，系统默认提示“此证书已标记为不受此账户信任”</p>
<p><img src="http://wd.geilicdn.com/81aa4272d837b2b5089093ee37107feb.png" style="max-width:100%;margin:5px 0 15px 0"></p>
<p>​     step3：选择“Charles Proxy Custom Root Certificate证书”，点击右键 =&gt;显示简介 =&gt; 点击“信任”，设置信任该证书；</p>
<p><img src="http://wd.geilicdn.com/66198466e8ade7ef662f74191c3b6d17.png" style="max-width:100%;margin:5px 0 15px 0"></p>
<p>​     step4：在charles菜单中选择”Proxy” =&gt; “SSL Proxying”，勾选“Enable SSL Proxying”，添加白名单域名列表</p>
<p><img src="http://wd.geilicdn.com/624f14bf20f84527c77ca7dbc164bb9a.png" style="max-width:100%;margin:5px 0 15px 0"></p>
<h4 id="其它功能">其它功能</h4>

<p> 网速限制，本地映射，需要大家去摸索。</p>
<p>end</p>

      
    </div>

    
      
      



      
      
    

    
      <footer class="post-footer">
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2017/11/22/本地Nginx配置/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">本地Nginx配置</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/2017/11/01/JS一些常用的缩写/">
        <span class="next-text nav-default">JS一些常用的缩写</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>


      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
  </div>


        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:songtao_st08@163.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="https://github.com/youstde" class="iconfont icon-github" title="github"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>



<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2015 - 
    
    2018

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">songtao</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  
  

  



    
  



  
  





  
    <script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  

  
    <script type="text/javascript" src="/lib/pjax/jquery.pjax.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/nprogress/nprogress.min.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=2.10.1"></script>

  </body>
</html>
